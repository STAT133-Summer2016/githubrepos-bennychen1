runApp('HW7App')
runApp('HW7App')
runApp('HW7App')
View(qa_plot)
View(qa_data)
runApp('HW7App')
View(states)
runApp('HW7App')
states_join <- states %>%
select(-c(order, subregion)) %>%
group_by(region) %>%
distinct()
View(states_join)
?semi_join
semi_join(states, states_join)
View(semi_join(states, states_join))
states_join <- states %>%
select(-c(order, subregion)) %>%
group_by(long, lat, region) %>%
distinct()
states %>% distinct(lat, long, region, group)
QandA <- load("question_data.Rdata")
linglocation <- read_delim("linglocation.txt", " ")
usa_states <- rownames(USArrests) %>%
str_to_lower()
usa_states[48] <- "west VA"
state_abbs <- state.abb
names(state_abbs) <- usa_states
lingdata <- read_delim("lingdata.txt", " " )  %>%
gather(qnum, Response, -c(ID, CITY, STATE, ZIP, lat, long)) %>%
mutate(qnum = str_replace_all(qnum, "Q[0]?", ""),
qnum = as.integer(qnum)) %>%
select(-c(ID, CITY, ZIP)) %>%
filter(STATE %in% state_abbs)
questions <- quest.mat %>%
filter(qnum  %in% lingdata$qnum) %>%
mutate(quest = str_replace_all(quest, "<[/]?[^>]>", ""))
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% as.integer(lingdata$qnum)) %>%
select(-ans.let, -per)
qa <- left_join(answers, questions)
qa_ling <- left_join(lingdata, qa, by = c("qnum" = "qnum", "Response" =
"Response"))%>%
select(-c(qnum)) %>%
filter(STATE != "HI", STATE != "AK")
View(qa_ling)
states_join <- states %>%
select(-c(order, subregion, lat, long)) %>%
distinct()
View(states_join)
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally() %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region"))
View(qa_data)
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally()
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally() %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally()
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally() %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally(ans)
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally(count(ans))
tally %>%
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group, lat, long) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(lat, long, STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
?geom_polygon
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n)) %>%
mutate(lat = states$lat,
long = states$long)
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n)) %>%
ungroup() %>%
mutate(lat = states$lat,
long = states$long)
runApp('HW7App')
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
tally %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n)) %>%
ungroup()
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(lat, long, STATE, ans, quest, Response, group) %>%
mutate(count = n())
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n())
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, n == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, count == max(n))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(STATE %in% state_abbs, count == max(count))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(Response !=0, count == max(count))
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(Response !=0, count == max(count)) %>%
write_csv(qa_data, "qa_data.csv")
qa_data <- inner_join(qa_ling, states_join, by = c("STATE" = "region")) %>%
group_by(STATE, ans, quest, Response, group) %>%
mutate(count = n()) %>%
group_by(STATE, quest) %>%
filter(Response !=0, count == max(count))
write_csv(qa_data, "qa_data.csv")
runApp('HW7App')
runApp('HW7App')
runApp('HW7App')
View(linglocation)
lingdata$qnum
answers$qnum
answers <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% lingdata$qnum) %>%
select(-ans.let, -per)
View(answers)
v_number <- str_c("V", 4:468)
answers <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% lingdata$qnum) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number)
answers <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(50, 51)) %>%
select(-ans.let, -per)
answers_loc <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(50, 51)) %>%
select(-ans.let, -per)
View(answers_loc)
v_number <- str_c("V", 4:15)
answers_loc <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(50, 51)) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number)
ling_loc <- linglocation %>%
gather(-c(Cell, `Number of people in cell`, Latitude, Longitude))
ling_loc <- linglocation %>%
gather(Answer, num_response, -c(Cell, `Number of people in cell`, Latitude, Longitude))
View(ling_loc)
v_replace <- answers_loc$v_num
v_replace <- answers_loc$ans
names(v_replace) = answers_loc$v_num
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude))
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude))
answers_loc$v_num
unique(ling_loc$Answer)
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num)
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
v_number <- str_c("V", 4:12)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(50)) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number)
v_replace <- answers_loc$ans
names(v_replace) = answers_loc$v_num
ling_loc <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
v_number50 <- str_c("V", 4:12)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc50 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(50)) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number50)
v_replace <- answers_loc$ans
names(v_replace) = answers_loc$v_num
ling_loc50 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
View(ling_loc50)
ggplot(states) +
geom_polygon(aes(x = long, y = lat))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = NA)
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white")
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = long, y = lat, fill = answer, size = num_Ans))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = answer, size = num_Ans))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_Ans))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_response))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_response),
size = 21)
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_response),
shape = 21)
ling_loc50 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -100) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_response),
shape = 21)
ling_loc50 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "white") +
geom_point(data = ling_loc50, aes(x = Longitude
, y = Latitude, fill = Answer, size = num_response),
shape = 21)
ggplot(ling_loc50) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
View(answers)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% as.integer(lingdata$qnum)) %>%
select(-ans.let, -per)
View(answers)
v_number51 <- str_c("V", 13:15)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc51 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% c(51)) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number51)
v_replace <- answers_loc$ans
names(v_replace) = answers_loc$v_num
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc51) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
ling_loc51
View(answer_loc51)
View(answers_loc51)
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50)
View(ling_loc51
)
v_number51 <- str_c("V", 13:15)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc51 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 51) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number51)
v_replace <- answers_loc51$ans
names(v_replace) = answers_loc$v_num
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc51) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
answers_loc51$ans
v_number51
v_replace <- answers_loc51$ans
names(v_replace) = answers_loc51$v_number
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc51) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
v_replace
v_replace <- answers_loc51$ans
names(v_replace) = answers_loc51$v_number
length(v_replace)
answers_loc51 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 51) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number51)
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc$v_num,
Longitude >= -130 & Longitude <= -50)
View(ling_loc51)
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc51$v_num,
Longitude >= -130 & Longitude <= -50)
ling_loc51 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc51$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc51) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
v_replace <- answers_loc51$ans
names(v_replace) = answers_loc51$v_number
answers[[52]]$ans
all.ans[[52]]
v_number52 <- str_c("V", 16:17)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc51 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 52) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number52)
v_replace <- answers_loc52$ans
names(v_replace) = answers_loc52$v_number
ling_loc52 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc52$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc52) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
v_number52 <- str_c("V", 16:17)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc52 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 52) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number52)
v_replace <- answers_loc52$ans
names(v_replace) = answers_loc52$v_number
ling_loc52 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc52$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc52) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
answers_loc52 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 52) %>%
select(-ans.let, -per)
View(answers_loc52)
v_number52 <- str_c("V", 16:18)
add_number <- function(i) {
mutate(all.ans[[i]], Response = c(1:nrow(all.ans[[i]])))
}
answers_list <- lapply(1:length(all.ans), add_number)
answers_loc52 <- data.frame(do.call(rbind, answers_list)) %>%
filter(qnum %in% 52) %>%
select(-ans.let, -per) %>%
mutate(v_num = v_number52)
v_replace <- answers_loc52$ans
names(v_replace) = answers_loc52$v_number
ling_loc52 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc52$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc52) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
answers_loc52$ans
v_replace <- c("V16", "V17", "V18")
names(v_replace) = answers_loc52$v_number
ling_loc52 <- linglocation %>%
gather(Answer, num_response,
-c(Cell, `Number of people in cell`, Latitude, Longitude)) %>%
filter(Answer %in% answers_loc52$v_num,
Longitude >= -130 & Longitude <= -50) %>%
mutate(Answer = str_replace_all(Answer, v_replace))
ggplot(ling_loc52) +
geom_point(aes(x = Longitude, y = Latitude, fill = Answer, size = num_response),
shape = 21)
v_replace
v_replace <- c("V16", "V17", "V18")
names(v_replace) <- answers_loc52$v_number
v_replace <- c("yes", "no", answers_loc52[3,2])
v_replace
answers_loc52[3,2]
v_replace <- answers_loc52$ans
v_replace <- factors(v_replace)
v_replace <- answers_loc52$ans
v_replace <- factor(v_replace)
names(v_replace) <- answers_loc52$v_number
v_repalce
v_replace
names(v_replace) <- answers_loc52$v_number
?droplevels
