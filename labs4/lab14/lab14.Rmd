---
title: "Lab14"
author: "Benny Chen"
date: "June 29, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
library(readr)
library(ggplot2)
library(stringr)
library(tidyr)
library(dplyr)
setwd("D:/stat133-su2016/14-lesson")
```
```{r}
setwd("D:/stat133-su2016/14-lesson")
economists <- read_csv("EconomistData.csv",
                       col_names=T,
                       col_types = "_cnnnc"
)
```
```{r}
ggplot(economists,aes(CPI,HDI)) + geom_point(aes(color=Region)) 
```
```{r}
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region))
```
```{r}
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5)
```
```{r}
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)
```
```{r}
points_to_label <- c("Russia", "Venezuela", "Iraq", "Myanmar", "Sudan",
                     "Afghanistan", "Congo", "Greece", "Argentina", "Brazil",
                     "India", "Italy", "China", "South Africa", "Spane",
                     "Botswana", "Cape Verde", "Bhutan", "Rwanda", "France",
                     "United States", "Germany", "Britain", "Barbados", "Norway", 
                     "Japan", "New Zealand", "Singapore")
label_df <- subset(economists,economists$Country %in% points_to_label)
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)+geom_text(data=label_df,aes(label=label_df$Country),color="grey20")
```
```{r}
library(ggrepel)
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)+geom_text_repel(data=label_df, aes(label=Country,color="grey20"))
```
```{r}
regions <- c("Asia Pacific" = "Asia & Oceania","East EU Cemt Asia"="Central & Eastern Europe","EU W. Europe"="OECD","MENA"="Middle East & north Africa","SSA"="Sub-Saharan Africa")

economists <- economists %>%
  mutate(Region = str_replace_all(Region,regions))
Region_factor <- factor(economists$Region,levels=c("OECD","Americas", "Asia & Oceania","Central & Eastern Europe","Middle East & north Africa","Sub-Saharan Africa"),labels=c("OECD","Americas", "Asia & Oceania","Central & Eastern Europe","Middle East & north Africa","Sub-Saharan Africa"))
economists <- mutate(economists, Region = Region_factor)
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)+geom_text(data=label_df,aes(label=label_df$Country),color="grey20") 
```
```{r}
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.8,stroke=1.6)+geom_text(data=label_df,aes(label=label_df$Country),color="grey20") + labs(title="Corruption and Human development",x="Corruption Perception Index,2011 (10=least corrupt",y="Human Development Index,2011(1=Best)")
```
```{r}
ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)+geom_text(data=label_df,aes(label=label_df$Country),color="grey20") + labs(title="Corruption and Human development",x="Corruption Perception Index,2011 (10=least corrupt)",y="Human Development Index,2011(1=Best)") + scale_x_continuous(limits=c(0,10),breaks=c(1:10)) + scale_y_continuous(limits =c(0,1),breaks=c(seq(0.2,0.9,0.1)))
```
```{r}
p <- ggplot(economists,aes(CPI,HDI)) +geom_smooth(method="lm",se=F, formula = y~log(x))+ geom_point(aes(color=Region),shape=1.5,size=1.5,stroke=1.5)+geom_text(data=label_df,aes(label=label_df$Country),color="grey20") + labs(title="Corruption and Human development",x="Corruption Perception Index,2011 (10=least corrupt)",y="Human Development Index,2011(1=Best)") + scale_x_continuous(limits=c(0,10),breaks=c(1:10)) + scale_y_continuous(limits =c(0.2,1),breaks=c(seq(0.2,0.9,0.1))) + scale_color_manual(values=c("#099DD7", "#248E84", "#28AADC", "#24576D", "#96503F","#F2583F"))
```
```{r}
z <- p + theme_minimal() + theme(legend.position="top")
z
```
```{r}
p <- p + theme_minimal() + theme(legend.position="top",axis.ticks.y=element_blank(),axis.ticks.x=element_blank(),text = element_text(color = "gray20"),
legend.justification = 0.1, 
legend.text = element_text(size = 11, color = "gray10"),
axis.text = element_text(face = "italic"),
axis.title.x = element_text(vjust = -1), 
axis.title.y = element_text(vjust = 2), 
axis.line = element_line(color = "gray40", size = 0.5),
panel.grid.major = element_line(color = "gray50", size = 0.5),
panel.grid.major.x = element_blank()) 
```
```{r}
library(gridExtra)
library(grid)
footnote <- "Sources: Transparency International; UN Human Development Report"
footgrob <- textGrob(footnote, x = 0, hjust = -0.1, vjust=0.1, gp = gpar(fontface = "italic", fontsize = 12))
g <- arrangeGrob(p, bottom = footgrob)
grid.draw(g)

```

