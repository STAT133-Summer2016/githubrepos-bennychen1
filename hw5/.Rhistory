France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate(Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start))
View(graph_df)
?guides
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) + theme(legend.title="Reactor Type")
?theme
graph_df <- full_join(France,Japan) %>%
mutate("Reactor Type" = str_replace_all("Reactor Type",types),net = as.integer(net),
const_start = dmy(const_start))
View(graph_df)
new_names <- c("name", "reactor", "Reactor Type", "model", "status",
"net", "gross", "const_start", "op_start", "closure")
types <- c(PWR="Pressurized Water", HWGCR = "Heavy Water Gas Cooled",GCR="Gas Cooled", FBR = "Fast Breeder", BWR="Boiling Water")
France <- table_list[[16]]
names(France) <- new_names
France <- slice(France,-1)
France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate("Reactor Type" = str_replace_all("Reactor Type",types),net = as.integer(net),
const_start = dmy(const_start))
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start)) %>%
rename(str_c("Reactor","Type",sep=" ") = Type)
?rename
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start)) %>%
rename("Reactor Type" = Type)
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start)) %>%
rename(`Reactor..Type` = Type)
new_names <- c("name", "reactor", "Type", "model", "status",
"net", "gross", "const_start", "op_start", "closure")
types <- c(PWR="Pressurized Water", HWGCR = "Heavy Water Gas Cooled",GCR="Gas Cooled", FBR = "Fast Breeder", BWR="Boiling Water")
France <- table_list[[16]]
names(France) <- new_names
France <- slice(France,-1)
France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start)) %>%
rename(`Reactor..Type` = Type)
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start)) %>%
rename("Reactor Type" = Type)
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape="Reactor Type"),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=`Reactor..Type`),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=names(graph_df[3])),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550))
new_names <- c("name", "reactor", "Type", "model", "status",
"net", "gross", "const_start", "op_start", "closure")
types <- c(PWR="Pressurized Water", HWGCR = "Heavy Water Gas Cooled",GCR="Gas Cooled", FBR = "Fast Breeder", BWR="Boiling Water")
France <- table_list[[16]]
names(France) <- new_names
France <- slice(France,-1)
France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) + labs(fill =  "Reactor Type")
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) + labs(shape = "Reactor Type")
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  + scale_y_discrete(labels=c(to_label)) + scale_x_date(limits=ymd(c("1958-01-01","2010-01-01")),date_breaks="5 years",date_minor_breaks = "2 years",labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",x="Date",y="Reactor Site")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  + scale_y_discrete(labels=c(to_label)) + scale_x_date(limits=ymd(c("1958-01-01","2010-01-01")),date_breaks="5 years",date_minor_breaks = "2 years",labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = ymd(c("1960-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = c(as,Date("1960-01-01"),as.Date("2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = c(as.Date("1960-01-01"),as.Date("2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = c(as.Date("1960-01-01"),as.Date("2010-01-01")),
date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
?scale_x_date
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(1960,2010,5),
date_minor_breaks = "2 years",                                      labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
y("1960")
year("1960")
ymd("1960")
as.Date("1960")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_continous(breaks = seq(1960,2010,5))
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_continuous(breaks = seq(1960,2010,5))
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label))
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label))
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
?scale_x_date
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",x="Construction Start Date",
y="Net Capacity (MW)") + scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),date_breaks="10 years",date_minor_breaks = "5 years",labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) + labs(shape = "Reactor Type")
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = ymd(c("1957-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(limits = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(limits = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y"),expand=c(0,0)) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(limits = ymd(c("1958-01-01","2010-01-01")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) + geom_segment(aes(x=dmy(const_start),y=name,xend=dmy(op_start),yend=name))  + labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
# Chunk 1
library(rvest)
library(xml2)
library(ggplot2)
library(lubridate)
library(stringr)
library(dplyr)
library(tidyr)
library(readr)
library(scales)
# Chunk 2
# remember that the dot shows where the pipe is placing the output
# of the function from the last line.  The third pipe leads into the subsetting
# operator.  This is probably where you want to remove problem nodes...
page <- "http://en.wikipedia.org/wiki/List_of_nuclear_reactors"
xpath <- '//div[@id="mw-content-text"]/table'
table_list <- page %>%
read_html() %>%
html_nodes(xpath = xpath) %>%
.[c(1:48,50:53)] %>%
html_table(fill = TRUE)
# The above code returns a list of tables.  Use subsetting to pick out specific tables
# A vector of names you might want in your initial data frame
new_names <- c("name", "reactor", "Type", "model", "status",
"net", "gross", "const_start", "op_start", "closure")
types <- c(PWR="Pressurized Water", HWGCR = "Heavy Water Gas Cooled",
GCR="Gas Cooled", FBR = "Fast Breeder", BWR="Boiling Water")
France <- table_list[[16]]
names(France) <- new_names
France <- slice(France,-1)
France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)") +
scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),
date_breaks="10 years",date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) +          labs(shape = "Reactor Type")
# An example of slice from the dplyr package.  It's like filter, but for picking
# out specific rows.  You may or may not use this.
df <- data.frame(x = 1:3, y = 4:6) %>%
slice(-1)
df %>% slice(c(1,3))
df %>% slice(-3)
# Chunk 3
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd(c("1958-01-01","2010-01-01"),by = "5 years")),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name))  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1958-01-01"),ymd("2010-01-01"),by = "5 years"),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name))  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"),ymd("2010-01-01"),by = "5 years"),
date_breaks="5 years",date_minor_breaks = "2 years",                                     labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name))  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df,aes(dmy(const_start),name_factors,color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
date_minor_breaks = "2 years", labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name))  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)") +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2005-01-01"),
by = "10 years"),
date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) +          labs(shape = "Reactor Type")
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)") +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "10 years"),
date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) +          labs(shape = "Reactor Type")
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)") +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2000-01-01"),
by = "10 years"),
date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) +          labs(shape = "Reactor Type")
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)") +
scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),
date_breaks="10 years",date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550)) +          labs(shape = "Reactor Type")
# Chunk 1
library(rvest)
library(xml2)
library(ggplot2)
library(lubridate)
library(stringr)
library(dplyr)
library(tidyr)
library(readr)
library(scales)
# Chunk 2
# remember that the dot shows where the pipe is placing the output
# of the function from the last line.  The third pipe leads into the subsetting
# operator.  This is probably where you want to remove problem nodes...
page <- "http://en.wikipedia.org/wiki/List_of_nuclear_reactors"
xpath <- '//div[@id="mw-content-text"]/table'
table_list <- page %>%
read_html() %>%
html_nodes(xpath = xpath) %>%
.[c(1:48,50:53)] %>%
html_table(fill = TRUE)
# The above code returns a list of tables.  Use subsetting to pick out specific tables
# A vector of names you might want in your initial data frame
new_names <- c("name", "reactor", "Type", "model", "status",
"net", "gross", "const_start", "op_start", "closure")
types <- c(PWR="Pressurized Water", HWGCR = "Heavy Water Gas Cooled",
GCR="Gas Cooled", FBR = "Fast Breeder", BWR="Boiling Water")
France <- table_list[[16]]
names(France) <- new_names
France <- slice(France,-1)
France <- mutate(France,Country="France")
Japan <- table_list[[23]]
names(Japan) <- new_names
Japan <- slice(Japan,-1)
Japan <- mutate(Japan,Country="Japan") %>%
filter(status != "Planned")
graph_df <- full_join(France,Japan) %>%
mutate( Type = str_replace_all(Type,types),net = as.integer(net),
const_start = dmy(const_start))
ggplot(graph_df,aes(const_start,net)) +
geom_point(aes(color=Country,shape=Type),size=2) +
labs(title="Net Reactor Capacities\n in France and Japan",
x="Construction Start Date",
y="Net Capacity (MW)",
shape = "Reactor Type") +
scale_x_date(limits=(ymd(c("1953-01-01","2005-01-01"))),
date_breaks="10 years",date_minor_breaks = "5 years",
labels=date_format("%Y")) + scale_y_continuous(limits=c(0,1550))
# An example of slice from the dplyr package.  It's like filter, but for picking
# out specific rows.  You may or may not use this.
df <- data.frame(x = 1:3, y = 4:6) %>%
slice(-1)
df %>% slice(c(1,3))
df %>% slice(-3)
# Chunk 3
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
name_factors <- factor(Japan_df$name,levels=rev(Japan_df$name),
labels=rev(Japan_df$name))
Japan_df <- mutate(Japan_df,name=name_factors) %>%
arrange(name) %>%
filter(status != "Under construction")
ggplot(Japan_df, aes(dmy(const_start), name_factors, color=Type)) +
scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name))  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",
x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
to_label <- sapply(Japan_df$name,create_label)
to_label
Japan_df1 <- filter(Japan,reactor==1)
Japan_df2 <- Japan %>%
filter(reactor != 1) %>%
mutate(name = str_c(name,reactor, sep=" "))
Japan_df <- full_join(Japan_df1,Japan_df2) %>%
arrange(name) %>%
mutate(Type = str_replace_all(Type,types))
create_label <- function(x) {
if(str_detect(x,"[0-9]")) {
str_replace(x,"^.*$"," ")
} else {
return(x)
}
}
to_label <- sapply(Japan_df$name,create_label)
?guides
?geom_segment
ggplot(Japan_df, aes(dmy(const_start), name_factors, color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name), alpha = "type")  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")  + guides(alpha=FALSE)
ggplot(Japan_df, aes(dmy(const_start), name_factors, color=Type))  +                          scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name), alpha = "reactor")  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",                               x="Date",y="Reactor Site") + labs(colour = "Reactor Type")  + guides(alpha=FALSE)
Japan_df
View(Japan_df)
ggplot(Japan_df, aes(dmy(const_start), name_factors, color=Type)) +
scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name), alpha = "reactor")  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",
x="Date",y="Reactor Site") + labs(colour = "Reactor Type")
ggplot(Japan_df, aes(dmy(const_start), name_factors, color=Type)) +
scale_y_discrete(labels=c(to_label)) +
scale_x_date(breaks = seq(ymd("1960-01-01"), ymd("2010-01-01"),
by = "5 years"),
labels=date_format("%Y")) +
geom_segment(aes(x=dmy(const_start),
y=name,xend=dmy(op_start),yend=name), alpha = "reactor")  +
labs(title="Construction Times For \n Japanese Nuclear Reactors",
x="Date",y="Reactor Site") + labs(colour = "Reactor Type") + guides(alpha = F)
